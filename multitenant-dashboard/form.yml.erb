---
form:
  - version
  - enable_multitenant
  - client_group
  - mt_method
  - mt_delivery_select
  - mt_delivery
  - mt_appname
<% IO.foreach(template_root+"form_params_gpu") do |line| %>
<%= line %>
<% end %>   
  
attributes:
  gpudata:
    widget: hidden_field
    cacheable: false
    value: |
      "<%= gpu_data.to_json %>"
      
  cluster:
    widget: select
    options:
      <%- CustomQueues.clusters.each do |g| %>
      - "<%= g %>"
      <%- end %>
<% IO.foreach(template_root+"friscos_v2") do |line| %>
<%= line %>
<% end %>
<% IO.foreach(template_root+"cluster-help") do |line| %>
<%= line %>
<% end %>    

  custom_accpart:
    widget: select
    options:
      <%- CustomAccPart.accpart.each do |g| %>
      - "<%= g %>"
      <%- end %>
<% IO.foreach(template_root+"accpart-help") do |line| %>
<%= line %>
<% end %>    

<% IO.foreach(template_root+"job_params_v33") do |line| %>
<%= line %>
<% end %>  
################################################################################
################################################################################
  version: 
    label: "R Version"
    widget: 'select'
    options:
      - [ "R/4.4.0" ]
      - [ "R/4.4.0-bioconductor" ]
      - [ "R/4.4.2" ]
      - [ "R/4.4.0-basic" ]
      - [ "R/4.4.0-geospatial" ]
################################################################################
################################################################################
  enable_multitenant:
    label: "Multitenant App Options"
    widget: 'select'
    options:
      - [
          'No Multitenancy', 'none',
          data-set-mt-method: 'form',
          data-set-mt-delivery-select: 0,
          data-set-client-group: <%= CurrentUser.group_names[0].to_s %>,
          data-hide-mt-method: true,
          data-hide-mt-delivery-select: true,
          data-hide-client-group: true,
        ]
      - [
          'My User Only', 'user',
          data-set-mt-method: 'form',
          data-set-mt-delivery-select: 0,
          data-set-client-group: <%= CurrentUser.group_names[0].to_s %>,
          data-hide-mt-method: true,
          data-hide-mt-delivery-select: true,
          data-hide-client-group: true,
        ]
      - [
          'Other Users', 'mt',
          data-set-mt-delivery-select: 0,
          data-hide-mt-method: false,
          data-hide-mt-delivery-select: true,
          data-hide-client-group: false,
        ]
    help: |
      Do you want your job to be shared with select users?
      
  client_group:
    label: "Tenant Group"
    widget: 'select'
    options:
      <%- %x{id -Gn $USER}.split(' ').each do |group| %>
      - ["<%= group %>"]
      <%- end %>
    help: Select the group of users that should connect to your app.

  mt_method:
    label: "Delivery Method"
    help: |
      What type of view do you want your users to see?
    widget: select
    options:
      - [
          "Form View Only", "form",
          data-hide-mt-delivery-select: true,
          data-set-mt-delivery-select: 0,
        ]
      - [
          "Card + Form View", "card",
          data-hide-mt-delivery-select: false,
          data-set-mt-delivery-select: 0,
        ]
  mt_delivery_select:
    widget: "select"
    label: "Card Preset"
    options:
      - [
          "Default R Shiny App", 0,
          data-set-mt-delivery: "sys/multitenant-delivery_default",
          data-set-mt-appname: "RShiny_App"
        ]
      - [
          "Debug", 2,
          data-set-mt-delivery: "sys/multitenant-delivery_debug",
          data-set-mt-appname: "debug"
        ]
    help: |
      The style of card you want delivered to tenants.
  mt_delivery:
    widget: "hidden_field"
  mt_appname:
    widget: "hidden_field"

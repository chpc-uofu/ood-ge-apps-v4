# Wait for the Jupyter Notebook server to start
echo "Waiting for Jupyter Notebook server to open port ${port}..."
if wait_until_port_used "${host}:${port}" 600; then
  echo "Discovered Jupyter Notebook server listening on port ${port}!"
else
  echo "Timed out waiting for Jupyter Notebook server to open port ${port}!"
  clean_up 1
fi
# Wait for the AF2 NIM server to start
echo "Waiting for Alphafold2 NIM server to open port 8081..."
if wait_until_port_used "${host}:8081" 600; then
  echo "Discovered Alphafold2 NIM server listening on port 8081!"
else
  echo "Timed out waiting for Alphafold2 NIM server to open port 8081!"
  clean_up 1
fi
# Wait for the RFDiffusion NIM server to start
echo "Waiting for RFDiffusion NIM server to open port 8082..."
if wait_until_port_used "${host}:8082" 600; then
  echo "Discovered RFDiffusion NIM server listening on port 8082!"
else
  echo "Timed out waiting for RFDiffusion NIM server to open port 8082!"
  clean_up 1
fi
# Wait for the ProteinMPNN NIM server to start
echo "Waiting for ProteinMPNN NIM server to open port 8083..."
if wait_until_port_used "${host}:8083" 600; then
  echo "Discovered ProteinMPNN NIM server listening on port 8083!"
else
  echo "Timed out waiting for ProteinMPNN server to open port 8083!"
  clean_up 1
fi
# Wait for the Alphafold 2 multimer NIM server to start
echo "Waiting for Alphafold 2 multimer NIM server to open port 8084..."
if wait_until_port_used "${host}:8084" 600; then
  echo "Discovered Alphafold 2 multimer NIM server listening on port 8084!"
else
  echo "Timed out waiting for Alphafold 2 multimer NIM  server to open port 8084!"
  clean_up 1
fi

sleep 2
